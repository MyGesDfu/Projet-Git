#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# R√©cup√©rer tous les fichiers suivis (ajout√©s/modifi√©s) avant le push
files=$(git diff --staged --name-only --diff-filter=ACM) # A: Added, C: Copied, M: Modified

for file in $files; do
    # V√©rifier si le fichier existe et est un fichier texte (√©vite les binaires)
    if [[ -f "$file" ]] && [[ $(file --mime-type -b "$file") == text/* ]]; then
        # V√©rifier si le fichier contient "var_dump"
        if grep -q "var_dump" "$file"; then
            echo "‚ùå ERREUR : Le fichier '$file' contient un 'var_dump'."
            echo "üö® Supprimez tous les 'var_dump' avant de pousser votre code."
            exit 1
        fi
    fi
done

echo "‚úÖ Aucun 'var_dump' d√©tect√©. Pouss√©e autoris√©e."
exit 0
